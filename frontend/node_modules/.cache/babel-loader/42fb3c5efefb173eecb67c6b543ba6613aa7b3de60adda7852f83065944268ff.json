{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\discopony\\\\Desktop\\\\MSchool\\\\Notion automation\\\\Railway_Rent\\\\frontend\\\\src\\\\components\\\\EquipmentModal.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport { createPortal } from \"react-dom\";\nimport API_BASE_URL from \"../config\";\nimport LoadingSpinner from \"./LoadingSpinner\";\nimport { getCategoryColor } from \"../utils/categoryColors\";\nimport \"./EquipmentModal.css\";\n\n// Вспомогательная функция для проверки конфликтов\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst checkConflicts = (start_date, end_date, status) => {\n  const now = new Date();\n  const newConflicts = [];\n  if (!start_date || !end_date) {\n    newConflicts.push({\n      message: \"❌ Укажите дату начала и окончания аренды\",\n      severity: \"error\"\n    });\n    return newConflicts;\n  }\n  const startDateTime = new Date(start_date);\n  const endDateTime = new Date(end_date);\n\n  // Конфликт 3: Дата возврата раньше даты выдачи\n  if (startDateTime >= endDateTime) {\n    newConflicts.push({\n      message: \"❌ Дата возврата не может быть раньше даты выдачи!\",\n      severity: \"error\"\n    });\n  }\n\n  // Конфликт 1: Дата выдачи прошла, но статус \"Бронь\"\n  if (startDateTime <= now && status === \"Бронь\") {\n    newConflicts.push({\n      message: \"⚠️ Время выдачи уже прошло, но оборудование еще не выдано\",\n      severity: \"warning\"\n    });\n  }\n\n  // Конфликт 2: Дата возврата прошла, но статус не \"Возвращено\"\n  if (endDateTime <= now && (status === \"Бронь\" || status === \"Выдано\")) {\n    newConflicts.push({\n      message: \"⚠️ Время возврата прошло, но оборудование еще не возвращено\",\n      severity: \"warning\"\n    });\n  }\n  return newConflicts;\n};\nconst EquipmentModal = ({\n  isOpen,\n  onClose,\n  booking,\n  onUpdate,\n  selectedEquipment,\n  onEquipmentChange,\n  onDelete\n}) => {\n  _s();\n  const [equipment, setEquipment] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [localSelectedEquipment, setLocalSelectedEquipment] = useState([]);\n  const [allBookings, setAllBookings] = useState([]);\n  const [rentalData, setRentalData] = useState({\n    start_date: \"\",\n    end_date: \"\",\n    renter: \"\",\n    issuer: \"\",\n    receiver: \"\",\n    where: \"в студии\",\n    status: \"Бронь\",\n    notes: \"\"\n  });\n\n  // Инициализация данных аренды при открытии модального окна\n  useEffect(() => {\n    if (isOpen && booking) {\n      setRentalData({\n        start_date: booking.start_date || \"\",\n        end_date: booking.end_date || \"\",\n        renter: booking.renter || \"\",\n        issuer: booking.issuer || \"\",\n        receiver: booking.receiver || \"\",\n        where: booking.where || \"в студии\",\n        status: booking.status || \"Бронь\",\n        notes: booking.notes || \"\"\n      });\n      // Инициализируем локальное выбранное оборудование\n      setLocalSelectedEquipment([...(selectedEquipment || [])]);\n    }\n  }, [isOpen, booking, selectedEquipment]);\n\n  // Загрузка оборудования\n  useEffect(() => {\n    if (!isOpen) return;\n    const fetchData = async () => {\n      try {\n        setLoading(true);\n\n        // Загружаем оборудование\n        let equipmentUrl = `${API_BASE_URL}/inventory`;\n        if (rentalData.start_date && rentalData.end_date) {\n          const params = new URLSearchParams({\n            start_date: rentalData.start_date,\n            end_date: rentalData.end_date\n          });\n          if (booking !== null && booking !== void 0 && booking.id) {\n            params.append('exclude_booking_id', booking.id);\n          }\n\n          // Всегда передаем текущее оборудование для правильного расчета доступности\n          const currentEquipmentJson = JSON.stringify(localSelectedEquipment || []);\n          params.append('current_equipment', currentEquipmentJson);\n          equipmentUrl = `${API_BASE_URL}/inventory/available?${params.toString()}`;\n        }\n\n        // Загружаем все бронирования для расчета \"Освободится\"\n        const [equipmentResponse, bookingsResponse] = await Promise.all([fetch(equipmentUrl), fetch(`${API_BASE_URL}/bookings`)]);\n        if (!equipmentResponse.ok) {\n          throw new Error(`Ошибка загрузки оборудования: ${equipmentResponse.status}`);\n        }\n        if (!bookingsResponse.ok) {\n          throw new Error(`Ошибка загрузки бронирований: ${bookingsResponse.status}`);\n        }\n        const equipmentData = await equipmentResponse.json();\n        const bookingsData = await bookingsResponse.json();\n        setEquipment(equipmentData);\n        setAllBookings(bookingsData);\n      } catch (error) {\n        console.error(\"Ошибка загрузки данных:\", error);\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchData();\n  }, [isOpen, rentalData.start_date, rentalData.end_date, booking === null || booking === void 0 ? void 0 : booking.id, localSelectedEquipment]);\n\n  // Блокировка скролла при открытии модального окна\n  useEffect(() => {\n    if (isOpen) {\n      document.body.classList.add('modal-open');\n      return () => {\n        document.body.classList.remove('modal-open');\n      };\n    }\n  }, [isOpen]);\n  const handleRentalDataChange = (field, value) => {\n    const newData = {\n      ...rentalData,\n      [field]: value\n    };\n    setRentalData(newData);\n    // Убираем автоматическое сохранение - теперь сохраняем только при клике на \"Сохранить\"\n  };\n\n  // Новая логика выбора оборудования: нельзя выбрать уже добавленное оборудование повторно\n  const handleEquipmentSelect = (item, event) => {\n    if (event) {\n      event.stopPropagation();\n      event.preventDefault();\n    }\n    // Если оборудование уже выбрано, не позволяем выбрать его повторно\n    if (localSelectedEquipment.some(eq => eq.id === item.id)) {\n      return;\n    }\n    const availableQuantity = getAvailableQuantity(item);\n    if (availableQuantity > 0) {\n      setLocalSelectedEquipment([...localSelectedEquipment, {\n        ...item,\n        quantity: 1\n      }]);\n    }\n    setSearchTerm(\"\"); // Очищаем поиск для следующего выбора\n  };\n  const handleEquipmentRemove = equipmentIndex => {\n    const updatedEquipment = localSelectedEquipment.filter((item, index) => index !== equipmentIndex);\n    setLocalSelectedEquipment(updatedEquipment);\n  };\n  const handleQuantityChange = (equipmentIndex, newQuantity) => {\n    if (newQuantity <= 0) {\n      handleEquipmentRemove(equipmentIndex);\n      return;\n    }\n\n    // Получаем информацию об элементе для проверки доступного количества\n    const currentItem = localSelectedEquipment[equipmentIndex];\n    const availableQuantity = getAvailableQuantity(currentItem);\n\n    // Ограничиваем количество доступным\n    const limitedQuantity = Math.min(newQuantity, availableQuantity);\n    const updatedEquipment = localSelectedEquipment.map((item, index) => {\n      if (index === equipmentIndex) {\n        return {\n          ...item,\n          quantity: limitedQuantity\n        };\n      }\n      return item;\n    });\n    setLocalSelectedEquipment(updatedEquipment);\n  };\n  const handleSaveAndClose = () => {\n    // Сохраняем данные аренды при закрытии\n    if (onUpdate) {\n      const updatedBooking = {\n        ...booking,\n        ...rentalData,\n        // Форматируем даты правильно для сохранения\n        start_date: formatDateForSaving(rentalData.start_date),\n        end_date: formatDateForSaving(rentalData.end_date),\n        equipment: localSelectedEquipment\n      };\n      onUpdate(booking.id, updatedBooking);\n    }\n    // Также обновляем выбранное оборудование через колбэк\n    if (onEquipmentChange) {\n      onEquipmentChange(localSelectedEquipment);\n    }\n    onClose();\n  };\n  const getAvailableQuantity = item => {\n    const selectedQuantity = localSelectedEquipment.filter(selected => selected.id === item.id).reduce((sum, selected) => sum + (selected.quantity || 0), 0);\n    const totalQuantity = item.total || 0;\n    const occupiedQuantity = item.occupied || 0;\n    const baseAvailable = totalQuantity - occupiedQuantity;\n    return Math.max(0, baseAvailable - selectedQuantity);\n  };\n  const getWillBeAvailable = item => {\n    if (!rentalData.start_date || !rentalData.end_date) return null;\n    const rentalStart = new Date(rentalData.start_date);\n    const rentalEnd = new Date(rentalData.end_date);\n\n    // Находим бронирования этого оборудования, которые пересекаются с нашими датами\n    const conflictingBookings = allBookings.filter(booking => {\n      if (!booking.equipment || booking.id === (booking === null || booking === void 0 ? void 0 : booking.id)) return false;\n      const hasThisEquipment = booking.equipment.some(eq => eq.id === item.id);\n      if (!hasThisEquipment) return false;\n      const bookingStart = new Date(booking.start_date);\n      const bookingEnd = new Date(booking.end_date);\n\n      // Проверяем пересечение дат\n      return bookingStart < rentalEnd && bookingEnd > rentalStart;\n    });\n\n    // Находим ближайшую дату освобождения\n    let nearestReleaseDate = null;\n    let willBeAvailableQuantity = 0;\n    conflictingBookings.forEach(booking => {\n      const bookingEnd = new Date(booking.end_date);\n      const equipmentQuantity = booking.equipment.filter(eq => eq.id === item.id).reduce((sum, eq) => sum + (eq.quantity || 0), 0);\n      if (!nearestReleaseDate || bookingEnd < nearestReleaseDate) {\n        nearestReleaseDate = bookingEnd;\n        willBeAvailableQuantity = equipmentQuantity;\n      }\n    });\n    return nearestReleaseDate ? {\n      date: nearestReleaseDate,\n      quantity: willBeAvailableQuantity\n    } : null;\n  };\n  const filteredEquipment = equipment.filter(item => item.name.toLowerCase().includes(searchTerm.toLowerCase()));\n  const formatDateForInput = dateString => {\n    if (!dateString) return \"\";\n    const date = new Date(dateString);\n    const year = date.getFullYear();\n    const month = String(date.getMonth() + 1).padStart(2, \"0\");\n    const day = String(date.getDate()).padStart(2, \"0\");\n    const hours = String(date.getHours()).padStart(2, \"0\");\n    const minutes = String(date.getMinutes()).padStart(2, \"0\");\n    return `${year}-${month}-${day}T${hours}:${minutes}`;\n  };\n  const formatDateForSaving = dateTimeValue => {\n    if (!dateTimeValue) return \"\";\n    const date = new Date(dateTimeValue);\n    // Возвращаем дату в локальном времени без конверсии в UTC\n    const year = date.getFullYear();\n    const month = String(date.getMonth() + 1).padStart(2, \"0\");\n    const day = String(date.getDate()).padStart(2, \"0\");\n    const hours = String(date.getHours()).padStart(2, \"0\");\n    const minutes = String(date.getMinutes()).padStart(2, \"0\");\n    const seconds = String(date.getSeconds()).padStart(2, \"0\");\n    return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;\n  };\n\n  // Проверяем конфликты для текущих данных аренды\n  const conflicts = checkConflicts(rentalData.start_date, rentalData.end_date, rentalData.status);\n  if (!isOpen) return null;\n  return /*#__PURE__*/createPortal(/*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"equipment-modal-overlay\",\n    onClick: handleSaveAndClose,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"equipment-modal-container\",\n      onClick: e => e.stopPropagation(),\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"equipment-modal-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"\\u0412\\u044B\\u0431\\u043E\\u0440 \\u043E\\u0431\\u043E\\u0440\\u0443\\u0434\\u043E\\u0432\\u0430\\u043D\\u0438\\u044F \\u0434\\u043B\\u044F \\u0430\\u0440\\u0435\\u043D\\u0434\\u044B\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 321,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: onClose,\n          className: \"modal-close-button\",\n          children: \"\\u2715\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 322,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 320,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"equipment-modal-body\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"rental-info-panel\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"\\u0418\\u043D\\u0444\\u043E\\u0440\\u043C\\u0430\\u0446\\u0438\\u044F \\u043E\\u0431 \\u0430\\u0440\\u0435\\u043D\\u0434\\u0435\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 328,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"rental-field\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"\\u0414\\u0430\\u0442\\u0430 \\u043D\\u0430\\u0447\\u0430\\u043B\\u0430:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 331,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"datetime-local\",\n              value: formatDateForInput(rentalData.start_date),\n              onChange: e => handleRentalDataChange('start_date', e.target.value),\n              step: \"900\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 332,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 330,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"rental-field\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"\\u0414\\u0430\\u0442\\u0430 \\u043E\\u043A\\u043E\\u043D\\u0447\\u0430\\u043D\\u0438\\u044F:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 341,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"datetime-local\",\n              value: formatDateForInput(rentalData.end_date),\n              onChange: e => handleRentalDataChange('end_date', e.target.value),\n              step: \"900\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 342,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 340,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"rental-field\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"\\u0410\\u0440\\u0435\\u043D\\u0434\\u0430\\u0442\\u043E\\u0440:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 351,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              value: rentalData.renter,\n              onChange: e => handleRentalDataChange('renter', e.target.value),\n              placeholder: \"\\u0418\\u043C\\u044F \\u0430\\u0440\\u0435\\u043D\\u0434\\u0430\\u0442\\u043E\\u0440\\u0430\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 352,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 350,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"rental-field\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"\\u041A\\u0442\\u043E \\u0432\\u044B\\u0434\\u0430\\u043B:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 361,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              value: rentalData.issuer,\n              onChange: e => handleRentalDataChange('issuer', e.target.value),\n              placeholder: \"\\u041A\\u0442\\u043E \\u0432\\u044B\\u0434\\u0430\\u043B\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 362,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 360,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"rental-field\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"\\u041A\\u0442\\u043E \\u043F\\u0440\\u0438\\u043D\\u044F\\u043B:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 371,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              value: rentalData.receiver,\n              onChange: e => handleRentalDataChange('receiver', e.target.value),\n              placeholder: \"\\u041A\\u0442\\u043E \\u043F\\u0440\\u0438\\u043D\\u044F\\u043B\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 372,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 370,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"rental-field\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"\\u0413\\u0434\\u0435:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 381,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              value: rentalData.where,\n              onChange: e => handleRentalDataChange('where', e.target.value),\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"\\u0432 \\u0441\\u0442\\u0443\\u0434\\u0438\\u0438\",\n                children: \"\\u0412 \\u0441\\u0442\\u0443\\u0434\\u0438\\u0438\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 386,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"\\u043D\\u0430 \\u0432\\u044B\\u043D\\u043E\\u0441\",\n                children: \"\\u041D\\u0430 \\u0432\\u044B\\u043D\\u043E\\u0441\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 387,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 382,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 380,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"rental-field\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"\\u0421\\u0442\\u0430\\u0442\\u0443\\u0441:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 392,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              value: rentalData.status,\n              onChange: e => handleRentalDataChange('status', e.target.value),\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"\\u0411\\u0440\\u043E\\u043D\\u044C\",\n                children: \"\\u0411\\u0440\\u043E\\u043D\\u044C\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 397,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"\\u0412\\u044B\\u0434\\u0430\\u043D\\u043E\",\n                children: \"\\u0412\\u044B\\u0434\\u0430\\u043D\\u043E\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 398,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"\\u0412\\u043E\\u0437\\u0432\\u0440\\u0430\\u0449\\u0435\\u043D\\u043E\",\n                children: \"\\u0412\\u043E\\u0437\\u0432\\u0440\\u0430\\u0449\\u0435\\u043D\\u043E\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 399,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 393,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 391,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"rental-field\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"\\u041F\\u0440\\u0438\\u043C\\u0435\\u0447\\u0430\\u043D\\u0438\\u044F:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 404,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n              value: rentalData.notes,\n              onChange: e => handleRentalDataChange('notes', e.target.value),\n              placeholder: \"\\u0414\\u043E\\u043F\\u043E\\u043B\\u043D\\u0438\\u0442\\u0435\\u043B\\u044C\\u043D\\u044B\\u0435 \\u043F\\u0440\\u0438\\u043C\\u0435\\u0447\\u0430\\u043D\\u0438\\u044F\",\n              rows: \"3\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 405,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 403,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 327,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"selected-equipment-panel\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"\\u0412\\u044B\\u0431\\u0440\\u0430\\u043D\\u043D\\u043E\\u0435 \\u043E\\u0431\\u043E\\u0440\\u0443\\u0434\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 416,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"selected-equipment-list\",\n            children: localSelectedEquipment.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"no-equipment-message\",\n              children: \"\\u041E\\u0431\\u043E\\u0440\\u0443\\u0434\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435 \\u043D\\u0435 \\u0432\\u044B\\u0431\\u0440\\u0430\\u043D\\u043E\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 419,\n              columnNumber: 33\n            }, this) : localSelectedEquipment.map((eq, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"selected-equipment-item\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"equipment-color-bar\",\n                style: {\n                  backgroundColor: getCategoryColor(eq.category)\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 425,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"equipment-details\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"equipment-name\",\n                  children: eq.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 430,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"equipment-meta\",\n                  children: [\"\\u041A\\u043E\\u043B\\u0438\\u0447\\u0435\\u0441\\u0442\\u0432\\u043E:\", /*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"number\",\n                    min: \"1\",\n                    max: getAvailableQuantity(eq) + (eq.quantity || 0),\n                    value: eq.quantity || 1,\n                    onChange: e => handleQuantityChange(index, parseInt(e.target.value)),\n                    className: \"quantity-input\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 433,\n                    columnNumber: 49\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 431,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 429,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => handleEquipmentRemove(index),\n                className: \"remove-equipment-button\",\n                children: \"\\u2715\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 443,\n                columnNumber: 41\n              }, this)]\n            }, index, true, {\n              fileName: _jsxFileName,\n              lineNumber: 424,\n              columnNumber: 37\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 417,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 415,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"equipment-selection-panel\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"\\u0414\\u043E\\u0441\\u0442\\u0443\\u043F\\u043D\\u043E\\u0435 \\u043E\\u0431\\u043E\\u0440\\u0443\\u0434\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 457,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"equipment-search\",\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              placeholder: \"\\uD83D\\uDD0D \\u041F\\u043E\\u0438\\u0441\\u043A \\u043E\\u0431\\u043E\\u0440\\u0443\\u0434\\u043E\\u0432\\u0430\\u043D\\u0438\\u044F...\",\n              value: searchTerm,\n              onChange: e => setSearchTerm(e.target.value),\n              className: \"equipment-search-input\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 460,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 459,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"equipment-list-container\",\n            children: loading ? /*#__PURE__*/_jsxDEV(LoadingSpinner, {\n              message: \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 471,\n              columnNumber: 33\n            }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"equipment-list\",\n              children: filteredEquipment.length > 0 ? filteredEquipment.map(item => {\n                const availableQuantity = getAvailableQuantity(item);\n                const isAvailable = availableQuantity > 0;\n                const backgroundColor = getCategoryColor(item.category);\n                const selectedQuantity = localSelectedEquipment.filter(eq => eq.id === item.id).reduce((sum, eq) => sum + (eq.quantity || 0), 0);\n                const willBeAvailable = getWillBeAvailable(item);\n                return /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: `equipment-item ${isAvailable ? 'available' : 'unavailable'} ${selectedQuantity > 0 ? 'selected' : ''}`,\n                  onClick: e => isAvailable && handleEquipmentSelect(item, e),\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"equipment-color-indicator\",\n                    style: {\n                      backgroundColor: backgroundColor\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 492,\n                    columnNumber: 53\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"equipment-info\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"equipment-name\",\n                      children: item.name\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 497,\n                      columnNumber: 57\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"equipment-stats\",\n                      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"stat available-stat\",\n                        children: [\"\\u0414\\u043E\\u0441\\u0442\\u0443\\u043F\\u043D\\u043E: \", availableQuantity]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 499,\n                        columnNumber: 61\n                      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"stat total-stat\",\n                        children: [\"\\u0412\\u0441\\u0435\\u0433\\u043E: \", item.total || 0]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 502,\n                        columnNumber: 61\n                      }, this), selectedQuantity > 0 && /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"stat selected-stat\",\n                        children: [\"\\u0412\\u044B\\u0431\\u0440\\u0430\\u043D\\u043E: \", selectedQuantity]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 506,\n                        columnNumber: 65\n                      }, this), willBeAvailable && /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"stat release-stat\",\n                        children: [\"\\u041E\\u0441\\u0432\\u043E\\u0431\\u043E\\u0434\\u0438\\u0442\\u0441\\u044F: \", willBeAvailable.quantity, \" (\", willBeAvailable.date.toLocaleString(), \")\"]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 511,\n                        columnNumber: 65\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 498,\n                      columnNumber: 57\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 496,\n                    columnNumber: 53\n                  }, this), selectedQuantity > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"selection-indicator\",\n                    children: \"\\u2713\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 518,\n                    columnNumber: 57\n                  }, this)]\n                }, item.id, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 487,\n                  columnNumber: 49\n                }, this);\n              }) : /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"no-results\",\n                children: searchTerm ? 'Оборудование не найдено' : 'Нет доступного оборудования'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 524,\n                columnNumber: 41\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 473,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 469,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 456,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 325,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"equipment-modal-footer\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => onDelete && onDelete(booking.id),\n          className: \"delete-button\",\n          children: \"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C \\u0437\\u0430\\u043F\\u0438\\u0441\\u044C\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 535,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"conflicts-indicator\",\n          children: conflicts.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"conflicts-display\",\n            children: conflicts.map((conflict, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `conflict-item ${conflict.severity}`,\n              title: conflict.message,\n              children: conflict.severity === 'error' ? '❌' : '⚠️'\n            }, index, false, {\n              fileName: _jsxFileName,\n              lineNumber: 545,\n              columnNumber: 37\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 543,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 541,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleSaveAndClose,\n          className: \"save-button\",\n          children: \"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C \\u0438 \\u0437\\u0430\\u043A\\u0440\\u044B\\u0442\\u044C\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 556,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 534,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 319,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 318,\n    columnNumber: 9\n  }, this), document.body || document.documentElement);\n};\n_s(EquipmentModal, \"bVEblV5tOyHuveRUyeYKKU6MNBY=\");\n_c = EquipmentModal;\nexport default EquipmentModal;\nvar _c;\n$RefreshReg$(_c, \"EquipmentModal\");","map":{"version":3,"names":["React","useState","useEffect","createPortal","API_BASE_URL","LoadingSpinner","getCategoryColor","jsxDEV","_jsxDEV","checkConflicts","start_date","end_date","status","now","Date","newConflicts","push","message","severity","startDateTime","endDateTime","EquipmentModal","isOpen","onClose","booking","onUpdate","selectedEquipment","onEquipmentChange","onDelete","_s","equipment","setEquipment","loading","setLoading","searchTerm","setSearchTerm","localSelectedEquipment","setLocalSelectedEquipment","allBookings","setAllBookings","rentalData","setRentalData","renter","issuer","receiver","where","notes","fetchData","equipmentUrl","params","URLSearchParams","id","append","currentEquipmentJson","JSON","stringify","toString","equipmentResponse","bookingsResponse","Promise","all","fetch","ok","Error","equipmentData","json","bookingsData","error","console","document","body","classList","add","remove","handleRentalDataChange","field","value","newData","handleEquipmentSelect","item","event","stopPropagation","preventDefault","some","eq","availableQuantity","getAvailableQuantity","quantity","handleEquipmentRemove","equipmentIndex","updatedEquipment","filter","index","handleQuantityChange","newQuantity","currentItem","limitedQuantity","Math","min","map","handleSaveAndClose","updatedBooking","formatDateForSaving","selectedQuantity","selected","reduce","sum","totalQuantity","total","occupiedQuantity","occupied","baseAvailable","max","getWillBeAvailable","rentalStart","rentalEnd","conflictingBookings","hasThisEquipment","bookingStart","bookingEnd","nearestReleaseDate","willBeAvailableQuantity","forEach","equipmentQuantity","date","filteredEquipment","name","toLowerCase","includes","formatDateForInput","dateString","year","getFullYear","month","String","getMonth","padStart","day","getDate","hours","getHours","minutes","getMinutes","dateTimeValue","seconds","getSeconds","conflicts","className","onClick","children","e","fileName","_jsxFileName","lineNumber","columnNumber","type","onChange","target","step","placeholder","rows","length","style","backgroundColor","category","parseInt","isAvailable","willBeAvailable","toLocaleString","conflict","title","documentElement","_c","$RefreshReg$"],"sources":["C:/Users/discopony/Desktop/MSchool/Notion automation/Railway_Rent/frontend/src/components/EquipmentModal.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { createPortal } from \"react-dom\";\nimport API_BASE_URL from \"../config\";\nimport LoadingSpinner from \"./LoadingSpinner\";\nimport { getCategoryColor } from \"../utils/categoryColors\";\nimport \"./EquipmentModal.css\";\n\n// Вспомогательная функция для проверки конфликтов\nconst checkConflicts = (start_date, end_date, status) => {\n    const now = new Date();\n    const newConflicts = [];\n\n    if (!start_date || !end_date) {\n        newConflicts.push({ \n            message: \"❌ Укажите дату начала и окончания аренды\", \n            severity: \"error\" \n        });\n        return newConflicts;\n    }\n\n    const startDateTime = new Date(start_date);\n    const endDateTime = new Date(end_date);\n\n    // Конфликт 3: Дата возврата раньше даты выдачи\n    if (startDateTime >= endDateTime) {\n        newConflicts.push({ \n            message: \"❌ Дата возврата не может быть раньше даты выдачи!\", \n            severity: \"error\" \n        });\n    }\n\n    // Конфликт 1: Дата выдачи прошла, но статус \"Бронь\"\n    if (startDateTime <= now && status === \"Бронь\") {\n        newConflicts.push({\n            message: \"⚠️ Время выдачи уже прошло, но оборудование еще не выдано\",\n            severity: \"warning\"\n        });\n    }\n\n    // Конфликт 2: Дата возврата прошла, но статус не \"Возвращено\"\n    if (endDateTime <= now && (status === \"Бронь\" || status === \"Выдано\")) {\n        newConflicts.push({\n            message: \"⚠️ Время возврата прошло, но оборудование еще не возвращено\",\n            severity: \"warning\"\n        });\n    }\n\n    return newConflicts;\n};\n\nconst EquipmentModal = ({ \n    isOpen, \n    onClose, \n    booking,\n    onUpdate,\n    selectedEquipment, \n    onEquipmentChange,\n    onDelete\n}) => {\n    const [equipment, setEquipment] = useState([]);\n    const [loading, setLoading] = useState(true);\n    const [searchTerm, setSearchTerm] = useState(\"\");\n    const [localSelectedEquipment, setLocalSelectedEquipment] = useState([]);\n    const [allBookings, setAllBookings] = useState([]);\n    const [rentalData, setRentalData] = useState({\n        start_date: \"\",\n        end_date: \"\",\n        renter: \"\",\n        issuer: \"\", \n        receiver: \"\",\n        where: \"в студии\",\n        status: \"Бронь\",\n        notes: \"\"\n    });\n\n    // Инициализация данных аренды при открытии модального окна\n    useEffect(() => {\n        if (isOpen && booking) {\n            setRentalData({\n                start_date: booking.start_date || \"\",\n                end_date: booking.end_date || \"\",\n                renter: booking.renter || \"\",\n                issuer: booking.issuer || \"\",\n                receiver: booking.receiver || \"\",\n                where: booking.where || \"в студии\",\n                status: booking.status || \"Бронь\",\n                notes: booking.notes || \"\"\n            });\n            // Инициализируем локальное выбранное оборудование\n            setLocalSelectedEquipment([...(selectedEquipment || [])]);\n        }\n    }, [isOpen, booking, selectedEquipment]);\n\n    // Загрузка оборудования\n    useEffect(() => {\n        if (!isOpen) return;\n\n        const fetchData = async () => {\n            try {\n                setLoading(true);\n                \n                // Загружаем оборудование\n                let equipmentUrl = `${API_BASE_URL}/inventory`;\n                \n                if (rentalData.start_date && rentalData.end_date) {\n                    const params = new URLSearchParams({\n                        start_date: rentalData.start_date,\n                        end_date: rentalData.end_date,\n                    });\n                    \n                    if (booking?.id) {\n                        params.append('exclude_booking_id', booking.id);\n                    }\n                    \n                    // Всегда передаем текущее оборудование для правильного расчета доступности\n                    const currentEquipmentJson = JSON.stringify(localSelectedEquipment || []);\n                    params.append('current_equipment', currentEquipmentJson);\n                    \n                    equipmentUrl = `${API_BASE_URL}/inventory/available?${params.toString()}`;\n                }\n\n                // Загружаем все бронирования для расчета \"Освободится\"\n                const [equipmentResponse, bookingsResponse] = await Promise.all([\n                    fetch(equipmentUrl),\n                    fetch(`${API_BASE_URL}/bookings`)\n                ]);\n\n                if (!equipmentResponse.ok) {\n                    throw new Error(`Ошибка загрузки оборудования: ${equipmentResponse.status}`);\n                }\n                if (!bookingsResponse.ok) {\n                    throw new Error(`Ошибка загрузки бронирований: ${bookingsResponse.status}`);\n                }\n\n                const equipmentData = await equipmentResponse.json();\n                const bookingsData = await bookingsResponse.json();\n                \n                setEquipment(equipmentData);\n                setAllBookings(bookingsData);\n            } catch (error) {\n                console.error(\"Ошибка загрузки данных:\", error);\n            } finally {\n                setLoading(false);\n            }\n        };\n\n        fetchData();\n    }, [isOpen, rentalData.start_date, rentalData.end_date, booking?.id, localSelectedEquipment]);\n\n    // Блокировка скролла при открытии модального окна\n    useEffect(() => {\n        if (isOpen) {\n            document.body.classList.add('modal-open');\n            return () => {\n                document.body.classList.remove('modal-open');\n            };\n        }\n    }, [isOpen]);\n\n    const handleRentalDataChange = (field, value) => {\n        const newData = { ...rentalData, [field]: value };\n        setRentalData(newData);\n        // Убираем автоматическое сохранение - теперь сохраняем только при клике на \"Сохранить\"\n    };\n\n    // Новая логика выбора оборудования: нельзя выбрать уже добавленное оборудование повторно\n    const handleEquipmentSelect = (item, event) => {\n        if (event) {\n            event.stopPropagation();\n            event.preventDefault();\n        }\n        // Если оборудование уже выбрано, не позволяем выбрать его повторно\n        if (localSelectedEquipment.some(eq => eq.id === item.id)) {\n            return;\n        }\n        const availableQuantity = getAvailableQuantity(item);\n        if (availableQuantity > 0) {\n            setLocalSelectedEquipment([...localSelectedEquipment, { ...item, quantity: 1 }]);\n        }\n        setSearchTerm(\"\"); // Очищаем поиск для следующего выбора\n    };\n\n    const handleEquipmentRemove = (equipmentIndex) => {\n        const updatedEquipment = localSelectedEquipment.filter((item, index) => index !== equipmentIndex);\n        setLocalSelectedEquipment(updatedEquipment);\n    };\n\n    const handleQuantityChange = (equipmentIndex, newQuantity) => {\n        if (newQuantity <= 0) {\n            handleEquipmentRemove(equipmentIndex);\n            return;\n        }\n        \n        // Получаем информацию об элементе для проверки доступного количества\n        const currentItem = localSelectedEquipment[equipmentIndex];\n        const availableQuantity = getAvailableQuantity(currentItem);\n        \n        // Ограничиваем количество доступным\n        const limitedQuantity = Math.min(newQuantity, availableQuantity);\n        \n        const updatedEquipment = localSelectedEquipment.map((item, index) => {\n            if (index === equipmentIndex) {\n                return { ...item, quantity: limitedQuantity };\n            }\n            return item;\n        });\n        setLocalSelectedEquipment(updatedEquipment);\n    };\n\n    const handleSaveAndClose = () => {\n        // Сохраняем данные аренды при закрытии\n        if (onUpdate) {\n            const updatedBooking = {\n                ...booking,\n                ...rentalData,\n                // Форматируем даты правильно для сохранения\n                start_date: formatDateForSaving(rentalData.start_date),\n                end_date: formatDateForSaving(rentalData.end_date),\n                equipment: localSelectedEquipment\n            };\n            onUpdate(booking.id, updatedBooking);\n        }\n        // Также обновляем выбранное оборудование через колбэк\n        if (onEquipmentChange) {\n            onEquipmentChange(localSelectedEquipment);\n        }\n        onClose();\n    };\n\n    const getAvailableQuantity = (item) => {\n        const selectedQuantity = localSelectedEquipment\n            .filter(selected => selected.id === item.id)\n            .reduce((sum, selected) => sum + (selected.quantity || 0), 0);\n        \n        const totalQuantity = item.total || 0;\n        const occupiedQuantity = item.occupied || 0;\n        const baseAvailable = totalQuantity - occupiedQuantity;\n        \n        return Math.max(0, baseAvailable - selectedQuantity);\n    };\n\n    const getWillBeAvailable = (item) => {\n        if (!rentalData.start_date || !rentalData.end_date) return null;\n        \n        const rentalStart = new Date(rentalData.start_date);\n        const rentalEnd = new Date(rentalData.end_date);\n        \n        // Находим бронирования этого оборудования, которые пересекаются с нашими датами\n        const conflictingBookings = allBookings.filter(booking => {\n            if (!booking.equipment || booking.id === booking?.id) return false;\n            \n            const hasThisEquipment = booking.equipment.some(eq => eq.id === item.id);\n            if (!hasThisEquipment) return false;\n            \n            const bookingStart = new Date(booking.start_date);\n            const bookingEnd = new Date(booking.end_date);\n            \n            // Проверяем пересечение дат\n            return bookingStart < rentalEnd && bookingEnd > rentalStart;\n        });\n        \n        // Находим ближайшую дату освобождения\n        let nearestReleaseDate = null;\n        let willBeAvailableQuantity = 0;\n        \n        conflictingBookings.forEach(booking => {\n            const bookingEnd = new Date(booking.end_date);\n            const equipmentQuantity = booking.equipment\n                .filter(eq => eq.id === item.id)\n                .reduce((sum, eq) => sum + (eq.quantity || 0), 0);\n            \n            if (!nearestReleaseDate || bookingEnd < nearestReleaseDate) {\n                nearestReleaseDate = bookingEnd;\n                willBeAvailableQuantity = equipmentQuantity;\n            }\n        });\n        \n        return nearestReleaseDate ? {\n            date: nearestReleaseDate,\n            quantity: willBeAvailableQuantity\n        } : null;\n    };\n\n    const filteredEquipment = equipment.filter(item => \n        item.name.toLowerCase().includes(searchTerm.toLowerCase())\n    );\n\n    const formatDateForInput = (dateString) => {\n        if (!dateString) return \"\";\n        const date = new Date(dateString);\n        const year = date.getFullYear();\n        const month = String(date.getMonth() + 1).padStart(2, \"0\");\n        const day = String(date.getDate()).padStart(2, \"0\");\n        const hours = String(date.getHours()).padStart(2, \"0\");\n        const minutes = String(date.getMinutes()).padStart(2, \"0\");\n        return `${year}-${month}-${day}T${hours}:${minutes}`;\n    };\n\n    const formatDateForSaving = (dateTimeValue) => {\n        if (!dateTimeValue) return \"\";\n        const date = new Date(dateTimeValue);\n        // Возвращаем дату в локальном времени без конверсии в UTC\n        const year = date.getFullYear();\n        const month = String(date.getMonth() + 1).padStart(2, \"0\");\n        const day = String(date.getDate()).padStart(2, \"0\");\n        const hours = String(date.getHours()).padStart(2, \"0\");\n        const minutes = String(date.getMinutes()).padStart(2, \"0\");\n        const seconds = String(date.getSeconds()).padStart(2, \"0\");\n        return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;\n    };\n\n    // Проверяем конфликты для текущих данных аренды\n    const conflicts = checkConflicts(rentalData.start_date, rentalData.end_date, rentalData.status);\n\n    if (!isOpen) return null;\n\n    return createPortal(\n        <div className=\"equipment-modal-overlay\" onClick={handleSaveAndClose}>\n            <div className=\"equipment-modal-container\" onClick={(e) => e.stopPropagation()}>\n                <div className=\"equipment-modal-header\">\n                    <h2>Выбор оборудования для аренды</h2>\n                    <button onClick={onClose} className=\"modal-close-button\">✕</button>\n                </div>\n\n                <div className=\"equipment-modal-body\">\n                    {/* Левая панель - информация об аренде */}\n                    <div className=\"rental-info-panel\">\n                        <h3>Информация об аренде</h3>\n                        \n                        <div className=\"rental-field\">\n                            <label>Дата начала:</label>\n                            <input\n                                type=\"datetime-local\"\n                                value={formatDateForInput(rentalData.start_date)}\n                                onChange={(e) => handleRentalDataChange('start_date', e.target.value)}\n                                step=\"900\"\n                            />\n                        </div>\n\n                        <div className=\"rental-field\">\n                            <label>Дата окончания:</label>\n                            <input\n                                type=\"datetime-local\"\n                                value={formatDateForInput(rentalData.end_date)}\n                                onChange={(e) => handleRentalDataChange('end_date', e.target.value)}\n                                step=\"900\"\n                            />\n                        </div>\n\n                        <div className=\"rental-field\">\n                            <label>Арендатор:</label>\n                            <input\n                                type=\"text\"\n                                value={rentalData.renter}\n                                onChange={(e) => handleRentalDataChange('renter', e.target.value)}\n                                placeholder=\"Имя арендатора\"\n                            />\n                        </div>\n\n                        <div className=\"rental-field\">\n                            <label>Кто выдал:</label>\n                            <input\n                                type=\"text\"\n                                value={rentalData.issuer}\n                                onChange={(e) => handleRentalDataChange('issuer', e.target.value)}\n                                placeholder=\"Кто выдал\"\n                            />\n                        </div>\n\n                        <div className=\"rental-field\">\n                            <label>Кто принял:</label>\n                            <input\n                                type=\"text\"\n                                value={rentalData.receiver}\n                                onChange={(e) => handleRentalDataChange('receiver', e.target.value)}\n                                placeholder=\"Кто принял\"\n                            />\n                        </div>\n\n                        <div className=\"rental-field\">\n                            <label>Где:</label> \n                            <select\n                                value={rentalData.where}\n                                onChange={(e) => handleRentalDataChange('where', e.target.value)}\n                            >\n                                <option value=\"в студии\">В студии</option>\n                                <option value=\"на вынос\">На вынос</option>\n                            </select>\n                        </div>\n\n                        <div className=\"rental-field\">\n                            <label>Статус:</label>\n                            <select\n                                value={rentalData.status}\n                                onChange={(e) => handleRentalDataChange('status', e.target.value)}\n                            >\n                                <option value=\"Бронь\">Бронь</option>\n                                <option value=\"Выдано\">Выдано</option>\n                                <option value=\"Возвращено\">Возвращено</option>\n                            </select>\n                        </div>\n\n                        <div className=\"rental-field\">\n                            <label>Примечания:</label>\n                            <textarea\n                                value={rentalData.notes}\n                                onChange={(e) => handleRentalDataChange('notes', e.target.value)}\n                                placeholder=\"Дополнительные примечания\"\n                                rows=\"3\"\n                            />\n                        </div>\n                    </div>\n\n                    {/* Центральная панель - выбранное оборудование */}\n                    <div className=\"selected-equipment-panel\">\n                        <h3>Выбранное оборудование</h3>\n                        <div className=\"selected-equipment-list\">\n                            {localSelectedEquipment.length === 0 ? (\n                                <div className=\"no-equipment-message\">\n                                    Оборудование не выбрано\n                                </div>\n                            ) : (\n                                localSelectedEquipment.map((eq, index) => (\n                                    <div key={index} className=\"selected-equipment-item\">\n                                        <div \n                                            className=\"equipment-color-bar\"\n                                            style={{ backgroundColor: getCategoryColor(eq.category) }}\n                                        />\n                                        <div className=\"equipment-details\">\n                                            <div className=\"equipment-name\">{eq.name}</div>\n                                            <div className=\"equipment-meta\">\n                                                Количество: \n                                                <input \n                                                    type=\"number\"\n                                                    min=\"1\"\n                                                    max={getAvailableQuantity(eq) + (eq.quantity || 0)}\n                                                    value={eq.quantity || 1}\n                                                    onChange={(e) => handleQuantityChange(index, parseInt(e.target.value))}\n                                                    className=\"quantity-input\"\n                                                />\n                                            </div>\n                                        </div>\n                                        <button \n                                            onClick={() => handleEquipmentRemove(index)}\n                                            className=\"remove-equipment-button\"\n                                        >\n                                            ✕\n                                        </button>\n                                    </div>\n                                ))\n                            )}\n                        </div>\n                    </div>\n\n                    {/* Правая панель - выбор оборудования */}\n                    <div className=\"equipment-selection-panel\">\n                        <h3>Доступное оборудование</h3>\n                        \n                        <div className=\"equipment-search\">\n                            <input\n                                type=\"text\"\n                                placeholder=\"🔍 Поиск оборудования...\"\n                                value={searchTerm}\n                                onChange={(e) => setSearchTerm(e.target.value)}\n                                className=\"equipment-search-input\"\n                            />\n                        </div>\n\n                        <div className=\"equipment-list-container\">\n                            {loading ? (\n                                <LoadingSpinner message=\"Загрузка...\" />\n                            ) : (\n                                <div className=\"equipment-list\">\n                                    {filteredEquipment.length > 0 ? (\n                                        filteredEquipment.map((item) => {\n                                            const availableQuantity = getAvailableQuantity(item);\n                                            const isAvailable = availableQuantity > 0;\n                                            const backgroundColor = getCategoryColor(item.category);\n                                            \n                                            const selectedQuantity = localSelectedEquipment\n                                                .filter(eq => eq.id === item.id)\n                                                .reduce((sum, eq) => sum + (eq.quantity || 0), 0);\n                                            \n                                            const willBeAvailable = getWillBeAvailable(item);\n                                            \n                                            return (\n                                                <div\n                                                    key={item.id}\n                                                    className={`equipment-item ${isAvailable ? 'available' : 'unavailable'} ${selectedQuantity > 0 ? 'selected' : ''}`}\n                                                    onClick={(e) => isAvailable && handleEquipmentSelect(item, e)}\n                                                >\n                                                    <div \n                                                        className=\"equipment-color-indicator\"\n                                                        style={{ backgroundColor: backgroundColor }}\n                                                    />\n                                                    <div className=\"equipment-info\">\n                                                        <div className=\"equipment-name\">{item.name}</div>\n                                                        <div className=\"equipment-stats\">\n                                                            <span className=\"stat available-stat\">\n                                                                Доступно: {availableQuantity}\n                                                            </span>\n                                                            <span className=\"stat total-stat\">\n                                                                Всего: {item.total || 0}\n                                                            </span>\n                                                            {selectedQuantity > 0 && (\n                                                                <span className=\"stat selected-stat\">\n                                                                    Выбрано: {selectedQuantity}\n                                                                </span>\n                                                            )}\n                                                            {willBeAvailable && (\n                                                                <span className=\"stat release-stat\">\n                                                                    Освободится: {willBeAvailable.quantity} ({willBeAvailable.date.toLocaleString()})\n                                                                </span>\n                                                            )}\n                                                        </div>\n                                                    </div>\n                                                    {selectedQuantity > 0 && (\n                                                        <div className=\"selection-indicator\">✓</div>\n                                                    )}\n                                                </div>\n                                            );\n                                        })\n                                    ) : (\n                                        <div className=\"no-results\">\n                                            {searchTerm ? 'Оборудование не найдено' : 'Нет доступного оборудования'}\n                                        </div>\n                                    )}\n                                </div>\n                            )}\n                        </div>\n                    </div>\n                </div>\n\n                <div className=\"equipment-modal-footer\">\n                    <button \n                        onClick={() => onDelete && onDelete(booking.id)} \n                        className=\"delete-button\"\n                    >\n                        Удалить запись\n                    </button>\n                    <div className=\"conflicts-indicator\">\n                        {conflicts.length > 0 && (\n                            <div className=\"conflicts-display\">\n                                {conflicts.map((conflict, index) => (\n                                    <div \n                                        key={index} \n                                        className={`conflict-item ${conflict.severity}`}\n                                        title={conflict.message}\n                                    >\n                                        {conflict.severity === 'error' ? '❌' : '⚠️'}\n                                    </div>\n                                ))}\n                            </div>\n                        )}\n                    </div>\n                    <button onClick={handleSaveAndClose} className=\"save-button\">\n                        Сохранить и закрыть\n                    </button>\n                </div>\n            </div>\n        </div>,\n        document.body || document.documentElement\n    );\n};\n\nexport default EquipmentModal;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}